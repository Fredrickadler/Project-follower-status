<script>
    // Mock data (replace with API if you have one)
    const followerData = {
        realFollowers: 10000,
        filteredFollowers: 9200,
        changes: {
            last24h: [9600, 9700, 9800, 9900, 9950, 10000],
            last7d: [9000, 9200, 9400, 9600, 9700, 9800, 10000],
            last30d: [8000, 8500, 8800, 9000, 9500, 9700, 10000]
        }
    };

    // GSAP animations
    gsap.from('.container', { scale: 0.7, opacity: 0, duration: 2, ease: 'power4.out' });
    gsap.from('.profile-pic', { y: -300, opacity: 0, duration: 1.2, ease: 'bounce.out', delay: 0.5 });
    gsap.from('.profile h2', { x: -200, opacity: 0, duration: 1, ease: 'power3.out', delay: 0.8 });
    gsap.from('.profile p', { x: 200, opacity: 0, duration: 1, ease: 'power3.out', delay: 1 });
    gsap.from('.follower-box', { scale: 0, opacity: 0, duration: 1.5, stagger: 0.3, ease: 'elastic.out(1, 0.4)', delay: 1.2 });
    gsap.from('.charts', { y: 300, opacity: 0, duration: 1.5, ease: 'power4.out', delay: 1.5 });

    // Animate follower counts
    gsap.fromTo(
        '#real-followers',
        { innerText: 0 },
        { innerText: followerData.realFollowers, duration: 3, ease: 'power2.out', snap: { innerText: 1 } }
    );
    gsap.fromTo(
        '#filtered-followers',
        { innerText: 0 },
        { innerText: followerData.filteredFollowers, duration: 3, ease: 'power2.out', snap: { innerText: 1 } }
    );

    // Custom Chart.js plugin for glowing points
    const glowPlugin = {
        id: 'glowPlugin',
        beforeDraw(chart) {
            const ctx = chart.ctx;
            chart.data.datasets.forEach(dataset => {
                dataset.data.forEach((value, index) => {
                    const meta = chart.getDatasetMeta(0);
                    const point = meta.data[index];
                    if (point) {
                        ctx.beginPath();
                        ctx.arc(point.x, point.y, 12, 0, 2 * Math.PI);
                        ctx.fillStyle = 'rgba(255, 0, 255, 0.3)';
                        ctx.fill();
                    }
                });
            });
        }
    };

    // Chart setup
    Chart.register(glowPlugin);
    const ctx = document.getElementById('chart-canvas').getContext('2d');
    let followerChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['6h ago', '12h ago', '18h ago', '24h ago', '7d ago', '30d ago'],
            datasets: [
                {
                    label: 'Real Followers',
                    data: followerData.changes.last24h,
                    borderColor: '#ff00ff',
                    backgroundColor: 'rgba(255, 0, 255, 0.5)',
                    fill: true,
                    tension: 0.6,
                    pointBackgroundColor: '#00ff88',
                    pointBorderColor: '#fff',
                    pointRadius: 8,
                    pointHoverRadius: 12,
                    pointStyle: 'circle'
                }
            ]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: false,
                    ticks: { 
                        color: '#00ff88', 
                        font: { size: 18 },
                        callback: value => value.toLocaleString()
                    },
                    grid: { color: 'rgba(255, 0, 255, 0.2)' }
                },
                x: {
                    ticks: { color: '#00ff88', font: { size: 18 } },
                    grid: { color: 'rgba(255, 0, 255, 0.2)' }
                }
            },
            plugins: {
                legend: {
                    labels: { color: '#ff00ff', font: { size: 20 } }
                },
                tooltip: {
                    backgroundColor: 'rgba(10, 10, 20, 0.9)',
                    titleColor: '#ff00ff',
                    bodyColor: '#00ff88',
                    borderColor: '#ff00ff',
                    borderWidth: 2
                }
            },
            animation: {
                duration: 3000,
                easing: 'easeOutBounce',
                onComplete: () => {
                    gsap.to('#chart-canvas', { scale: 1.02, duration: 0.5, yoyo: true, repeat: 1 });
                }
            }
        },
        plugins: [glowPlugin]
    });

    // Time toggle functionality
    const timeButtons = document.querySelectorAll('.time-btn');
    timeButtons.forEach(btn => {
        btn.addEventListener('click', () => {
            timeButtons.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            const timeFrame = btn.dataset.time;
            followerChart.data.datasets[0].data = followerData.changes[`last${timeFrame}`];
            followerChart.update();
            gsap.from('#chart-canvas', { 
                scale: 0.9, 
                opacity: 0.7, 
                duration: 0.7, 
                ease: 'power3.out',
                filter: 'drop-shadow(0 0 30px rgba(255, 0, 255, 0.8))'
            });
        });
    });
</script>